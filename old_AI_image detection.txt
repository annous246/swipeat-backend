

    const client = ModelClient(endpoint, new AzureKeyCredential(token));

// const response = await client.path("/chat/completions").post({
//   body: {
//     messages: [
//       {
//         role: "system",
//         content:
//           "You are a helpful nutrition assistant that can analyze food images",
//       },
//       {
//         role: "user",
//         content: [
//           {
//             type: "text",
//             text: "Please identify this food (in a max of 15 to 20 characters) and provide nutritional macros and total estimated portion in grams (g)",
//           },
//           {
//             type: "image_url",
//             image_url: {
//               url: url,
//             },
//           },
//         ],
//       },
//     ],
//     tools: function_definition,
//     tool_choice: {
//       type: "function",
//       function: { name: "extract_nutrition_facts" },
//     },
//     temperature: 0,
//     top_p: 1,
//     model: model,
//   },
// });

// if (isUnexpected(response)) {
//   console.error("Unexpected response:", JSON.stringify(response, null, 2));
//   const error = response.body?.error || {
//     message: "Unknown error occurred",
//     status: response.status,
//   };
//   throw new Error(JSON.stringify(error));
// }
// if (response.body.choices[0].finish_reason == "stop") {

    const openai = new OpenAI({
      baseURL: "https://openrouter.ai/api/v1",
      apiKey: process.env.OPENAPI_KEY,
    });
    url =
      "https://fitness-api-o543.onrender.com/uploads/1758751711725-photo.jpg";
    console.log(url);
    const response = await openai.chat.completions.create({
      model: "openai/gpt-5-mini",
      messages: [
        {
          role: "system",
          content:
            "You are a helpful nutrition assistant that can analyze food images",
        },
        {
          role: "user",
          content: `Please identify this food (max 15-20 characters) and provide nutritional macros and total estimated portion in grams (g). Image URL: """${url}""" `,
        },
      ],
      tools: function_definition,
      tool_call: { name: "extract_nutrition_facts" },
      temperature: 0,
      top_p: 1,
      max_completion_tokens: 2000,
    });

    console.log("response.choices[0].message");
    console.log(response.choices[0].message);
    console.log(response.choices[0].message.tool_calls[0].function.arguments);

    console.log(response.choices[0].finish_reason);